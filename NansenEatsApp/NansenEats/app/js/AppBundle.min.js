(function(){"use strict";var n=angular.module("app",["ngAnimate","ngRoute","ngSanitize","kendo.directives","LocalStorageModule"]);n.config(function(n){n.when("/",{templateUrl:"app/templates/restaurantlist.html"}).when("/login",{templateUrl:"app/templates/login.html"}).when("/signup",{templateUrl:"app/templates/signup.html"}).when("/restaurant/new-restaurant",{templateUrl:"app/templates/addrestaurant.html"}).when("/restaurant/:restaurantid",{templateUrl:"app/templates/restaurantdetails.html"}).when("/restaurant/:restaurantid/edit",{templateUrl:"app/templates/editrestaurant.html"}).when("/restaurant/:restaurantid/new-review",{templateUrl:"app/templates/addreview.html"}).when("/rating/:ratingid/edit",{templateUrl:"app/templates/editrating.html"}).when("/comment/:commentid/edit",{templateUrl:"app/templates/editcomment.html"}).when("/search/:searchTerm",{templateUrl:"app/templates/search.html"}).otherwise({redirectTo:"/"})});n.config(["localStorageServiceProvider",function(n){n.setPrefix("app")}]);n.config(function(n){n.interceptors.push("authInterceptorService")});n.run(["authService",function(n){n.fillAuthData()}])})(),function(){"use strict";function n(n){function t(t){return function(i){n.error(t,i)}}return{catcher:t}}angular.module("app").factory("exception",n);n.$inject=["logger"]}(),function(){"use strict";function n(n){function t(t,i){n.error("Error: "+t,i)}function i(t,i){n.info("Info: "+t,i)}function r(t,i){n.info("Success: "+t,i)}function u(t,i){n.warn("Warning: "+t,i)}return{error:t,info:i,success:r,warning:u,log:n.log}}angular.module("app").factory("logger",n);n.$inject=["$log"]}(),function(){"use strict";function n(){return{restrict:"EA",scope:{loadedproperty:"="},template:'<div ng-hide="loadedproperty" class="col-sm-12 loading"><\/div>'}}angular.module("app").directive("loader",n);n.$inject=["$window"]}(),function(){"use strict";function n(n,t,i,r){function u(n){return r.search(n).then(function(n){return n})}return{search:u}}angular.module("app").factory("util",n);n.$inject=["$http","$location","exception","dataservice"]}(),function(){"use strict";function n(n,t,i){var r={},u=function(n){n.headers=n.headers||{};var t=i.get("authorizationData");return t&&(n.headers.Authorization="Bearer "+t.token),n},f=function(i){return i.status===401&&t.path("/login"),n.reject(i)};return r.request=u,r.responseError=f,r}angular.module("app").factory("authInterceptorService",n);n.$inject=["$q","$location","localStorageService"]}(),function(){"use strict";function n(n,t,i){var e="http://eatsapi.local/",u={},r={isAuth:!1,userName:"",userId:"",userDisplayName:"",userImageUrl:"",userEmail:""},o=function(t){return f(),n.post(e+"api/account/register",t).then(function(n){return n})},s=function(u){var s="grant_type=password&username="+u.userName+"&password="+u.password,o=t.defer();return n.post(e+"token",s,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(n){var t=n.access_token,f=u.userName,e=n.userId,s=n.userDisplayName,h=n.userImageUrl,c=u.email;i.set("authorizationData",{token:t,userName:f,userId:e,userDisplayName:s,userImageUrl:h,userEmail:c});r.isAuth=!0;r.userName=u.userName;r.userId=n.userId;r.userDisplayName=n.displayName;o.resolve(n)}).error(function(n){f();o.reject(n)}),o.promise},f=function(){i.remove("authorizationData");r.isAuth=!1;r.userName="";r.userId="";r.userDisplayName="";r.userImageUrl="";r.userEmail=""},h=function(){var n=i.get("authorizationData");n&&(r.isAuth=!0,r.userName=n.userName,r.userId=n.userId,r.userDisplayName=n.userDisplayName,r.userImageUrl=n.userImageUrl,r.userEmail=n.userEmail)};return u.saveRegistration=o,u.login=s,u.logOut=f,u.fillAuthData=h,u.authentication=r,u}angular.module("app").factory("authService",n);n.$inject=["$http","$q","localStorageService"]}(),function(){"use strict";function n(n,t,i){function u(){function u(n){return n.data}return n.get(r+"/api/restaurants").then(u).catch(function(n){i.catcher("XHR Failed for getRestaurants")(n);t.url("/")})}function f(u){function f(n){return n.data}return n.get(r+"/api/restaurants/"+u).then(f).catch(function(n){i.catcher("XHR Failed for getRestaurant")(n);t.url("/")})}function e(t){function u(n){return n.data}return n.post(r+"/api/restaurants",t).then(u).catch(function(n){i.catcher("XHR Failed for addRestaurant")(n)})}function o(t,u){function f(n){return n.data}return n.put(r+"/api/restaurants/"+t,u).then(f).catch(function(n){i.catcher("XHR Failed for editRestaurant")(n)})}function s(){function u(n){return n.data}return n.get(r+"/api/categories").then(u).catch(function(n){i.catcher("XHR Failed for getTags")(n);t.url("/")})}function h(u){function f(n){return n.data}return n.get(r+"/api/rating/"+u).then(f).catch(function(n){i.catcher("XHR Failed for getRating")(n);t.url("/")})}function c(t){function u(n){return n.data}return n.post(r+"/api/rating",t).then(u).catch(function(n){i.catcher("XHR Failed for addRating")(n)})}function l(t,u){function f(n){return n.data}return n.put(r+"/api/rating/"+t,u).then(f).catch(function(n){i.catcher("XHR Failed for editRating")(n)})}function a(u){function f(n){return n.data}return n.get(r+"/api/comment/"+u).then(f).catch(function(n){i.catcher("XHR Failed for getComment")(n);t.url("/")})}function v(t){function u(n){return n.data}return n.post(r+"/api/comment",t).then(u).catch(function(n){i.catcher("XHR Failed for addComment")(n)})}function y(t,u){function f(n){return n.data}return n.put(r+"/api/comment/"+t,u).then(f).catch(function(n){i.catcher("XHR Failed for editComment")(n)})}function p(u){function f(n){return n.data}return n.get(r+"/api/search/?searchTerm="+u).then(f).catch(function(n){i.catcher("XHR Failed for search")(n);t.url("/")})}var r="http://eatsapi.local";return{getRestaurants:u,getRestaurant:f,addRestaurant:e,editRestaurant:o,getTags:s,getRating:h,addRating:c,editRating:l,getComment:a,addComment:v,editComment:y,search:p}}angular.module("app").factory("dataservice",n);n.$inject=["$http","$location","exception"]}(),function(){"use strict";function n(){function i(t){function i(){var n=document.createElement("script");n.type="text/javascript";n.src="https://maps.googleapis.com/maps/api/js?sensor=false&callback=initializeMap";window.initializeMap=r;document.body.appendChild(n)}function r(){var o=[n.name,n.lat,n.lng],r,e,s,h,i,u,f;for(t.unshift(o),e={mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1},r=new google.maps.Map(document.getElementById("map_canvas"),e),s=new google.maps.InfoWindow,u=new google.maps.LatLngBounds,i=0;i<t.length;i++)f=new google.maps.LatLng(t[i][1],t[i][2]),u.extend(f),h=new google.maps.Marker({position:f,map:r,title:t[i][0]}),r.fitBounds(u)}i()}var n={name:"Office",lat:41.8894833,lng:-87.6517529},t={};return t.load=i,t}angular.module("app").factory("googleMapsService",n);n.$inject=["$http","$location","exception"]}(),function(){"use strict";function n(n,t){var i=this;i.loginData={userName:"",password:""};i.message="";i.login=function(){t.login(i.loginData).then(function(){n.path("/")},function(n){i.message=n.error_description})}}angular.module("app").controller("LoginController",n);n.$inject=["$location","authService"]}(),function(){"use strict";function n(n,t,i){var r=this,u;r.savedSuccessfully=!1;r.message="";r.registration={userName:"",displayName:"",email:"",password:"",confirmPassword:""};r.signUp=function(){i.saveRegistration(r.registration).then(function(){r.savedSuccessfully=!0;r.message="User has been registered successfully, you will be redicted to login page in 2 seconds.";u()},function(n){var u=[],i,t;for(i in n.data.modelState)for(t=0;t<n.data.modelState[i].length;t++)u.push(n.data.modelState[i][t]);r.message="Failed to register user due to:"+u.join(" ")})};u=function(){var i=t(function(){t.cancel(i);n.path("/login")},2e3)}}angular.module("app").controller("SignupController",n);n.$inject=["$location","$timeout","authService"]}(),function(){"use strict";function n(n,t,i,r){function f(){u.offcanvasActive=!u.offcanvasActive}function e(){n.url("/search/"+u.searchTerm)}var u=this;u.title="ShellController";u.searchTerm="";u.search=e;u.offcanvasActive=!1;u.showOffcanvasButton=!0;u.toggleCanvas=f;u.logOut=function(){r.logOut();n.path("/")};u.authentication=r.authentication}angular.module("app").controller("ShellController",n);n.$inject=["$location","dataservice","logger","authService"]}(),function(){"use strict";function n(n,t,i,r){function e(){return u.searchTerm=r.searchTerm,f(u.searchTerm)}function f(n){return t.search(n).then(function(n){return u.results=n,u.results})}var u=this;u.title="SearchController";u.search=f;e()}angular.module("app").controller("SearchController",n);n.$inject=["$location","util","logger","$routeParams"]}(),function(){"use strict";function n(n,t,i){function u(n){if(r.sort==n){r.reverse=!r.reverse;return}r.sort=n;r.reverse=!1}function f(){return e().then(function(){i.info("Activated Restaurants View");r.changeSort("AverageRating")})}function e(){return t.getRestaurants().then(function(n){return r.restaurants=n,r.restaurants})}var r=this;r.title="RestaurantListController";r.restaurants=[];f();r.sort="AverageRating";r.reverse=!1;r.offcanvas=!0;r.sortGroup=[{Sort:"AverageRating",Name:"Rating"},{Sort:"DistanceFromOffice",Name:"Distance"},{Sort:"Name",Name:"Name"},{Sort:"PriceRangeMin",Name:"Price"}];r.changeSort=u}angular.module("app").controller("RestaurantListController",n);n.$inject=["$location","dataservice","logger","$routeParams"]}(),function(){"use strict";function n(n,t,i,r,u){function e(){return o().then(function(){r.info("Activated Restaurant Details View")})}function o(){return f.restaurantId=u.restaurantid,t.getRestaurant(f.restaurantId).then(function(n){if(f.restaurant=n,!f.restaurant.Ratings||!f.restaurant.Ratings.length||angular.forEach(f.restaurant.Ratings,function(n){if(!!n.Tags&&!!n.Tags.length){var t=n.Tags.map(function(n){return n.Name});n.TagNames=t.join(", ")}}),!!f.restaurant.Lat&&!!f.restaurant.Lng){var t=[[f.restaurant.Name,f.restaurant.Lat,f.restaurant.Lng]];i.load(t)}return f.restaurant})}var f=this;f.title="RestaurantDetailsController";f.restaurant={};e()}angular.module("app").controller("RestaurantDetailsController",n);n.$inject=["$location","dataservice","googleMapsService","logger","$routeParams"]}(),function(){"use strict";function n(n,t){function r(){u()}function u(){i.restaurant.city="Chicago"}function f(){i.restaurant&&t.addRestaurant(i.restaurant).then(function(t){t?n.url("/restaurant/"+t.Id):i.restaurant={}})}var i=this;i.title="AddRestaurantController";i.restaurant={};i.handleRestaurant=f;r()}angular.module("app").controller("AddRestaurantController",n);n.$inject=["$location","dataservice","logger"]}(),function(){"use strict";function n(n,t,i,r){function f(){return u.restaurantId=r.restaurantid,t.getRestaurant(u.restaurantId).then(function(n){return u.restaurant=n,u.restaurant})}function e(){u.restaurant&&t.editRestaurant(u.restaurantId,u.restaurant).then(function(t){t&&n.url("/restaurant/"+t.Id)})}var u=this;u.title="EditRestaurantController";u.restaurant={};u.handleRestaurant=e;f()}angular.module("app").controller("EditRestaurantController",n);n.$inject=["$location","dataservice","logger","$routeParams"]}(),function(){"use strict";function n(n,t,i,r){function f(){e()}function e(){u.rating.RestaurantId=r.restaurantid;u.comment.RestaurantId=r.restaurantid;t.getTags().then(function(n){n&&(u.availableTags=n,u.options={dataTextField:"Name",dataSource:u.availableTags,template:'<span title="#: Description#">#: Name#<\/span>',separator:", ",select:s})})}function o(){u.rating&&t.addRating(u.rating).then(function(i){i&&u.comment.Value?t.addComment(u.comment).then(function(t){t&&n.url("/restaurant/"+r.restaurantid)}):i?n.url("/restaurant/"+r.restaurantid):(u.rating.RestaurantId=r.restaurantid,u.comment.RestaurantId=r.restaurantid)})}function s(n){var t=this.dataItem(n.item.index());u.rating.Tags||(u.rating.Tags=[]);u.rating.Tags.push(t)}var u=this;u.title="AddReviewController";u.rating={};u.comment={};u.handleReview=o;u.showComment=!0;u.showRating=!0;u.availableTags=[];f()}angular.module("app").controller("AddReviewController",n);n.$inject=["$location","dataservice","logger","$routeParams"]}(),function(){"use strict";function n(n,t,i,r){function f(){u.ratingId=r.ratingid;t.getRating(u.ratingId).then(function(n){return u.rating=n,u.rating});t.getTags().then(function(n){n&&(u.availableTags=n,u.options={dataTextField:"Name",dataSource:u.availableTags,template:'<span title="#: Description#">#: Name#<\/span>',separator:", ",select:o})})}function e(){u.rating&&t.editRating(u.ratingId,u.rating).then(function(t){t&&n.url("/restaurant/"+t.RestaurantId)})}function o(n){var t=this.dataItem(n.item.index());u.rating.Tags||(u.rating.Tags=[]);u.rating.Tags.push(t)}var u=this;u.title="EditRatingController";u.rating={};u.handleReview=e;u.showComment=!1;u.showRating=!0;f()}angular.module("app").controller("EditRatingController",n);n.$inject=["$location","dataservice","logger","$routeParams"]}(),function(){"use strict";function n(n,t,i,r){function f(){return u.commentId=r.commentid,t.getComment(u.commentId).then(function(n){return u.comment=n,u.comment})}function e(){u.comment&&t.editComment(u.commentId,u.comment).then(function(t){t&&n.url("/restaurant/"+t.RestaurantId)})}var u=this;u.title="EditCommentController";u.rating={};u.handleReview=e;u.showComment=!0;u.showRating=!1;f()}angular.module("app").controller("EditCommentController",n);n.$inject=["$location","dataservice","logger","$routeParams"]}();
//# sourceMappingURL=AppBundle.min.js.map
