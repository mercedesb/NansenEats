/**
 * Copyright 2014 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

!function(e,define){define(["./kendo.list.min","./kendo.mobile.scroller.min"],e)}(function(){return function(e,t){var n=window.kendo,i=n.ui,a=i.List,o=i.Select,r=n.caret,s=n.support,l=s.placeholder,c=n._activeElement,u=n.keys,d=".kendoComboBox",f="click"+d,h="mousedown"+d,p="disabled",g="readonly",v="change",m="k-state-default",_="k-state-focused",b="k-state-disabled",k="aria-disabled",C="aria-readonly",w="k-state-selected",y="filter",F="accept",x="rebind",S="mouseenter"+d+" mouseleave"+d,T=null,D=e.proxy,M=o.extend({init:function(t,i){var a,r=this;r.ns=d,i=e.isArray(i)?{dataSource:i}:i,o.fn.init.call(r,t,i),i=r.options,t=r.element.on("focus"+d,D(r._focusHandler,r)),i.placeholder=i.placeholder||t.attr("placeholder"),r._reset(),r._wrapper(),r._input(),r._tabindex(r.input),r._popup(),r._dataSource(),r._ignoreCase(),r._enable(),r._oldIndex=r.selectedIndex=-1,r._cascade(),r._aria(),i.autoBind?r._filterSource():(a=i.text,!a&&r._isSelect&&(a=t.children(":selected").text()),a&&(r.input.val(a),r._prev=a)),a||r._placeholder(),n.notify(r)},options:{name:"ComboBox",enabled:!0,index:-1,text:null,value:null,autoBind:!0,delay:200,dataTextField:"",dataValueField:"",minLength:0,height:200,highlightFirst:!0,template:"",filter:"none",placeholder:"",suggest:!1,cascadeFrom:"",cascadeFromField:"",ignoreCase:!0,animation:{}},events:["open","close",v,"select","filtering","dataBinding","dataBound","cascade"],setOptions:function(e){o.fn.setOptions.call(this,e),this._template(),this._accessors(),this._aria()},current:function(e){var n=this,i=n._current;return e===t?i:(i&&i.removeClass(w),o.fn.current.call(n,e),t)},destroy:function(){var e=this;e.input.off(d),e.element.off(d),e._inputWrapper.off(d),o.fn.destroy.call(e)},_focusHandler:function(){this.input.focus()},_arrowClick:function(){this._toggle()},_inputFocus:function(){this._inputWrapper.addClass(_),this._placeholder(!1)},_inputFocusout:function(){var e=this;e._inputWrapper.removeClass(_),clearTimeout(e._typing),e._typing=null,e.options.text!==e.input.val()&&e.text(e.text()),e._placeholder(),e._blur(),e.element.blur()},_editable:function(e){var t=this,n=e.disable,i=e.readonly,a=t._inputWrapper.off(d),o=t.element.add(t.input.off(d)),r=t._arrow.parent().off(f+" "+h);i||n?(a.addClass(n?b:m).removeClass(n?m:b),o.attr(p,n).attr(g,i).attr(k,n).attr(C,i)):(a.addClass(m).removeClass(b).on(S,t._toggleHover),o.removeAttr(p).removeAttr(g).attr(k,!1).attr(C,!1),r.on(f,D(t._arrowClick,t)).on(h,function(e){e.preventDefault()}),t.input.on("keydown"+d,D(t._keydown,t)).on("focus"+d,D(t._inputFocus,t)).on("focusout"+d,D(t._inputFocusout,t)))},open:function(){var e=this,t=e._state,n=e.dataSource.options.serverFiltering;e.popup.visible()||(!e.ul[0].firstChild&&t!==y||t===F&&!n?(e._open=!0,e._state=x,e._filterSource()):(e.popup.open(),e._scroll(e._current)))},refresh:function(){var i,a,o=this,r=o.ul[0],s=o.options,l=o._state,u=o._data(),d=u.length,f=!0;o._angularItems("cleanup"),o.trigger("dataBinding"),r.innerHTML=n.render(o.template,u),o._height(d),o.popup.visible()&&o.popup._position(),o._isSelect&&(i=o.element[0].children[0],l===x&&(o._state=""),a=o._option,o._option=t,o._options(u),a&&a[0].selected?o._custom(a.val(),f):o._bound||i||o._custom("",f)),d&&(s.highlightFirst&&o.current(e(r.firstChild)),s.suggest&&o.input.val()&&o._request!==t&&o.suggest(e(r.firstChild))),l===y||o._fetch||o._selectItem(),o._open&&(o._open=!1,o._typing&&o.input[0]!==c()?o.popup.close():o.toggle(!!d),o._typing=null),o._touchScroller&&o._touchScroller.reset(),o._makeUnselectable(),o._hideBusy(),o._bound=!0,o._angularItems("compile"),o.trigger("dataBound")},suggest:function(e){var n,i=this,o=i.input[0],s=i.text(),l=r(o)[0],d=i._last;return d==u.BACKSPACE||d==u.DELETE?(i._last=t,t):(e=e||"","string"!=typeof e&&(n=a.inArray(e[0],i.ul[0]),e=n>-1?i._text(i.dataSource.view()[n]):""),0>=l&&(l=s.toLowerCase().indexOf(e.toLowerCase())+1),e?(n=e.toLowerCase().indexOf(s.toLowerCase()),n>-1&&(s+=e.substring(n+s.length))):s=s.substring(0,l),s.length===l&&e||(o.value=s,o===c()&&r(o,l,s.length)),t)},text:function(e){var n,i,a,o,r,s;return e=null===e?"":e,n=this,i=n.input[0],a=n.options.ignoreCase,o=e,e===t?i.value:(r=n.dataItem(),r&&n._text(r)===e&&(s=n._value(r),null===s?s="":s+="",s===n._old)?(n._triggerCascade(),t):(a&&(o=o.toLowerCase()),n._select(function(e){return e=n._text(e),a&&(e=(e+"").toLowerCase()),e===o}),0>n.selectedIndex&&(n._custom(e),i.value=e),n._prev=i.value,n._triggerCascade(),t))},toggle:function(e){this._toggle(e,!0)},value:function(e){var n,i=this,a=i.options;return e===t?i._accessor():(null!==e&&(e=""+e),i._selectedValue=e,!i._open&&e&&i._fetchItems(e)||(n=i._index(e),n>-1?i.select(n):(i.current(T),i._custom(e),(a.value!==e||a.text!==i.input.val())&&(i.text(e),i._placeholder())),i._old=i._accessor(),i._oldIndex=i.selectedIndex),t)},_accept:function(e){var t=this;e?t._focus(e):(t.text(t.text()),t._change())},_custom:function(t,n){var i=this,a=i.element,o=i._option;i._state!==y||n||(i._state=F),i._isSelect?(o||(o=i._option=e("<option/>"),a.append(o)),o.text(t),o[0].selected=!0):a.val(t),i._selectedValue=t},_filter:function(e){var n=this,i=n.options,a=n.dataSource,o=i.ignoreCase,r=function(i){var a=n._text(i);return a!==t?(a+="",""!==a&&""===e?!1:(o&&(a=a.toLowerCase()),0===a.indexOf(e))):t};return o&&(e=e.toLowerCase()),n.ul[0].firstChild?(-1!==n._highlight(r)&&(i.suggest&&n._current&&n.suggest(n._current),n.open()),n._hideBusy(),t):(a.one(v,function(){a.view()[0]&&n.search(e)}).fetch(),t)},_highlight:function(n){var i,o=this;return n===t||null===n?-1:(n=o._get(n),i=a.inArray(n[0],o.ul[0]),-1==i&&(o.options.highlightFirst&&!o.text()?(n=o.ul[0].firstChild,n&&(n=e(n))):n=T),o.current(n),i)},_input:function(){var t,n=this,i=n.element.removeClass("k-input")[0],a=i.accessKey,o=n.wrapper,r="input.k-input",s=i.name||"";s&&(s='name="'+s+'_input" '),t=o.find(r),t[0]||(o.append('<span tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default"><input '+s+'class="k-input" type="text" autocomplete="off"/><span tabindex="-1" unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(n.element),t=o.find(r)),t[0].style.cssText=i.style.cssText,i.maxLength>-1&&(t[0].maxLength=i.maxLength),t.addClass(i.className).val(this.options.text||i.value).css({width:"100%",height:i.style.height}).attr({role:"combobox","aria-expanded":!1}).show(),l&&t.attr("placeholder",n.options.placeholder),a&&(i.accessKey="",t[0].accessKey=a),n._focused=n.input=t,n._inputWrapper=e(o[0].firstChild),n._arrow=o.find(".k-icon").attr({role:"button",tabIndex:-1}),i.id&&n._arrow.attr("aria-controls",n.ul[0].id)},_keydown:function(e){var t=this,n=e.keyCode;t._last=n,clearTimeout(t._typing),t._typing=null,n==u.TAB||t._move(e)||t._search()},_placeholder:function(e){if(!l){var n,i=this,a=i.input,o=i.options.placeholder;if(o){if(n=i.value(),e===t&&(e=!n),a.toggleClass("k-readonly",e),!e){if(n)return;o=""}a.val(o),o||a[0]!==c()||r(a[0],0,0)}}},_search:function(){var e=this;e._typing=setTimeout(function(){var t=e.text();e._prev!==t&&(e._prev=t,e.search(t)),e._typing=null},e.options.delay)},_select:function(e){var n,i,a=this,o=a._data(),r=a._highlight(e);a.selectedIndex=r,-1!==r&&(a._state===y&&(a._state=F),a._current.addClass(w),o=o[r],n=a._text(o),i=a._value(o),null===i&&(i=""),a._prev=a.input[0].value=n,a._accessor(i!==t?i:n,r),a._selectedValue=a._accessor(),a._placeholder(),a._optionID&&a._current.attr("aria-selected",!0))},_wrapper:function(){var e=this,t=e.element,n=t.parent();n.is("span.k-widget")||(n=t.hide().wrap("<span />").parent(),n[0].style.cssText=t[0].style.cssText),e.wrapper=n.addClass("k-widget k-combobox k-header").addClass(t[0].className).css("display","")},_clearSelection:function(e,t){var n=this,i=e._selectedValue||e.value(),a=i&&-1===e.selectedIndex;(t||!i||a)&&(n.value(""),n.options.value="")}});i.plugin(M)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});